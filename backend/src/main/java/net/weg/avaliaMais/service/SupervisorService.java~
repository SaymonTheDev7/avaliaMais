package net.weg.avaliaMais.service;

import lombok.RequiredArgsConstructor;
import net.weg.avaliaMais.model.Supervisor;
import net.weg.avaliaMais.model.dto.response.SupervisorResponseDTO;
import net.weg.avaliaMais.repository.SupervisorRepository;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.PageRequest;
import org.springframework.data.domain.Pageable;
import org.springframework.stereotype.Service;

@Service
@RequiredArgsConstructor
public class SupervisorService {

    private final SupervisorRepository supervisorRepository;

    public SupervisorResponseDTO findPedagogicalAdvisorPerUsernameOrEmail(String username, String email) {
        return supervisorRepository.findByUsernameOrEmail(username, email)
                .map(SupervisorResponseDTO::new)
                .orElseThrow(() -> new RuntimeException("Coordenador/a pedagógico não encontrado com os dados: " + username + " " + email));
    }

    public SupervisorResponseDTO findPedagogicalTechniquePerUsernameOrEmail(String username, String email) {
        return supervisorRepository.findByUsernameOrEmail(username, email)
                .map(SupervisorResponseDTO::new)
                .orElseThrow(() -> new RuntimeException("Técnico/a pedagógico não encontrado com os dados: " + username + " " + email));
    }

    public Page<SupervisorResponseDTO> findAllPedagogicalAdvisors(String type, int page, int size) {
        Pageable pageable = PageRequest.of(page, size);
        Page<Supervisor> pedagogicalAdvisorPage = supervisorRepository.findAll(type, pageable);
        return pedagogicalAdvisorPage.map(SupervisorResponseDTO::new);
    }

    public SupervisorResponseDTO findTeacherPerUsernameOrEmail(String username, String email) {
        return supervisorRepository.findByUsernameOrEmail(username, email)
                .map(SupervisorResponseDTO::new)
                .orElseThrow(() -> new RuntimeException("Professor não encontrado com os dados: " + username + " " + email));
    }

    public Page<SupervisorResponseDTO> findAllTeachers(String type, int page, int size) {
        Pageable pageable = PageRequest.of(page, size);
        Page<Supervisor> teacherPage = supervisorRepository.findAll(type, pageable);
        return teacherPage.map(SupervisorResponseDTO::new);
    }

    public SupervisorResponseDTO findStudentPerUsernameOrEmail(String username, String email) {
        return supervisorRepository.findByUsernameOrEmail(username, email)
                .map(SupervisorResponseDTO::new)
                .orElseThrow(() -> new RuntimeException("Aluno não encontrado com os dados: " + username + " " + email));
    }

    public Page<SupervisorResponseDTO> findAllStudents(String type, int page, int size) {
        Pageable pageable = PageRequest.of(page, size);
        Page<Supervisor> studentPage = supervisorRepository.findAll(type, pageable);
        return studentPage.map(SupervisorResponseDTO::new);
    }

    public SupervisorResponseDTO findSupervisorPerUsernameOrEmail(String username, String email) {
        return supervisorRepository.findByUsernameOrEmail(username, email)
                .map(SupervisorResponseDTO::new)
                .orElseThrow(() -> new RuntimeException("Supervisor não encontrado com os dados: " + username + " " + email));
    }

    public Page<SupervisorResponseDTO> findAllSupervisors(int page, int size) {
        Pageable pageable = PageRequest.of(page, size);
        Page<Supervisor> supervisorPage = supervisorRepository.findAll(pageable);
        return supervisorPage.map(SupervisorResponseDTO::new);
    }

    public SupervisorResponseDTO findClassPerName(String nameClass) {
        return supervisorRepository.findByNameClass(nameClass)
                .map(SupervisorResponseDTO::new)
                .orElseThrow(() -> new RuntimeException("Turma não encontrada com os dados: " + nameClass));
    }

    public SupervisorResponseDTO findClassPerYear(Integer year) {
        return supervisorRepository.findByYear(year)
                .map(SupervisorResponseDTO::new)
                .orElseThrow(() -> new RuntimeException("Turma não encontrada com os dados: " + year));
    }

    public SupervisorResponseDTO findClassPerLocation(String location) {
        return supervisorRepository.findByLocation(location)
                .map(SupervisorResponseDTO::new)
                .orElseThrow(() -> new RuntimeException("Turma não encontrada com os dados: " + location));
    }

    public SupervisorResponseDTO findClassPerShift(String shift) {
        return supervisorRepository.findByShift(shift)
                .map(SupervisorResponseDTO::new)
                .orElseThrow(() -> new RuntimeException("Turma não encontrada com os dados: " + shift));
    }

    public Page<SupervisorResponseDTO> findAllClasses(int page, int size) {
        Pageable pageable = PageRequest.of(page, size);
        Page<Supervisor> classPage = supervisorRepository.findAll(pageable);
        return classPage.map(SupervisorResponseDTO::new);
    }

    public SupervisorResponseDTO findCoursePerName(String nameCourse) {
        return supervisorRepository.findByNameCourse(nameCourse)
                .map(SupervisorResponseDTO::new)
                .orElseThrow(() -> new RuntimeException("Curso não encontrado com os dados: " + nameCourse));
    }

    public SupervisorResponseDTO findCoursePerType(String typeCourse) {
        return supervisorRepository.findByTypeCourse(typeCourse)
                .map(SupervisorResponseDTO::new)
                .orElseThrow(() -> new RuntimeException("Curso não encontrado com os dados: " + typeCourse));
    }

    public Page<SupervisorResponseDTO> findAllCourses(int page, int size) {
        Pageable pageable = PageRequest.of(page, size);
        Page<Supervisor> coursePage = supervisorRepository.findAll(pageable);
        return coursePage.map(SupervisorResponseDTO::new);
    }
}
